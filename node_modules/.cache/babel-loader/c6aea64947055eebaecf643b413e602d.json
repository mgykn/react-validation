{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\taertan\\\\git\\\\onemessaging\\\\src\\\\layouts\\\\popupcontents\\\\OtpSmsPopup.js\";\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Form from '../../components/form/form';\nimport { otpSms, dispatchItem } from '../../actions/actions';\n\nvar OtpSmsPopup =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(OtpSmsPopup, _React$Component);\n\n  function OtpSmsPopup(props) {\n    var _this;\n\n    _classCallCheck(this, OtpSmsPopup);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OtpSmsPopup).call(this, props));\n    _this.state = {\n      timer: 180,\n      formModel: {\n        otp: {\n          value: '',\n          name: 'otp',\n          type: 'text',\n          label: 'Sms şifresi',\n          placeholder: 'Sms şifresi',\n          error: 'Lütfen telefonunuza gelen sms şifresini girin.',\n          valid: false,\n          touched: false,\n          validationRules: {\n            isRequired: true\n          }\n        }\n      }\n    };\n    _this.changeActivePopup = _this.changeActivePopup.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(OtpSmsPopup, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.interval = setInterval(function () {\n        _this2.setState(function (prevState) {\n          return {\n            timer: prevState.timer - 1\n          };\n        });\n      }, 1000);\n\n      if (this.props.app.loginAccessToken == '') {\n        this.changeActivePopup('login');\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.state.timer === 0) {\n        clearInterval(this.interval);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.interval);\n    }\n  }, {\n    key: \"changeActivePopup\",\n    value: function changeActivePopup(activePopup) {\n      this.props.dispatch(dispatchItem('POPUP', activePopup));\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(data) {\n      var _this3 = this;\n\n      this.props.dispatch(otpSms(data, function (data) {\n        if (data.statusCode == \"0\") {\n          var accessToken = data.token;\n          var userType = data.role;\n          localStorage.setItem('user', accessToken);\n          localStorage.setItem('userType', userType);\n\n          _this3.props.dispatch(dispatchItem('ACCESS_TOKEN', {\n            accessToken: accessToken,\n            userType: userType\n          }));\n\n          _this3.props.dispatch(dispatchItem('LOGIN_ACCESS_TOKEN', ''));\n\n          _this3.props.dispatch(dispatchItem('POPUP', ''));\n\n          if (userType == 'Sales') {\n            _this3.props.history.push('/agent/company/detail');\n          } else if (userType == 'Standart') {\n            _this3.props.history.push('/user');\n          }\n        } else if (data.statusCode == \"1\" || data.statusCode == \"2\") {\n          var accessToken = data.token;\n\n          _this3.props.dispatch(dispatchItem('LOGIN_ACCESS_TOKEN', accessToken));\n\n          _this3.changeActivePopup('changePassword');\n        }\n      }, function () {}));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"popup-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"popup-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, \"Telefonuna Gelen SMS Kodunu Gir\"), React.createElement(\"div\", {\n        className: \"form-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, React.createElement(Form, {\n        model: this.state.formModel,\n        handleSubmit: this.handleSubmit,\n        smallTitle: \"\",\n        buttonText: \"Giriş Yap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"popup-bottom\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"div\", {\n        className: \"popup-bottom-right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, \"Kalan s\\xFCre: \", (\"0\" + Math.floor(this.state.timer / 60)).slice(\"-2\"), \":\", (\"0\" + this.state.timer % 60).slice(\"-2\"))));\n    }\n  }]);\n\n  return OtpSmsPopup;\n}(React.Component);\n\nfunction mapStateToProps(state) {\n  return {\n    app: state.app\n  };\n}\n\nexport default withRouter(connect(mapStateToProps)(OtpSmsPopup));","map":{"version":3,"sources":["C:\\Users\\taertan\\git\\onemessaging\\src\\layouts\\popupcontents\\OtpSmsPopup.js"],"names":["React","withRouter","connect","Form","otpSms","dispatchItem","OtpSmsPopup","props","state","timer","formModel","otp","value","name","type","label","placeholder","error","valid","touched","validationRules","isRequired","changeActivePopup","bind","handleSubmit","interval","setInterval","setState","prevState","app","loginAccessToken","clearInterval","activePopup","dispatch","data","statusCode","accessToken","token","userType","role","localStorage","setItem","history","push","Math","floor","slice","Component","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport {connect} from 'react-redux';\r\nimport Form from '../../components/form/form';\r\nimport { otpSms, dispatchItem } from '../../actions/actions';\r\n\r\nclass OtpSmsPopup extends React.Component {\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            timer: 180,\r\n            formModel: {\r\n                otp: {\r\n                    value: '',\r\n                    name: 'otp',\r\n                    type: 'text',\r\n                    label: 'Sms şifresi',\r\n                    placeholder: 'Sms şifresi',\r\n                    error: 'Lütfen telefonunuza gelen sms şifresini girin.',\r\n                    valid: false,\r\n                    touched: false,\r\n                    validationRules: {\r\n                        isRequired: true\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        \r\n        this.changeActivePopup = this.changeActivePopup.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    componentDidMount()\r\n    {\r\n        this.interval = setInterval(\r\n            () => { this.setState((prevState)=> ({ timer: prevState.timer - 1 })) },\r\n            1000\r\n        );\r\n        \r\n        if(this.props.app.loginAccessToken == '')\r\n        {\r\n            this.changeActivePopup('login');\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(){\r\n        if(this.state.timer === 0){ \r\n            clearInterval(this.interval);\r\n        }\r\n    }\r\n    \r\n    componentWillUnmount(){\r\n        clearInterval(this.interval);\r\n    }\r\n    \r\n    changeActivePopup(activePopup) {\r\n        this.props.dispatch(dispatchItem('POPUP', activePopup));\r\n    }\r\n\r\n    handleSubmit(data)\r\n    {\r\n        this.props.dispatch(otpSms(data, (data) => {\r\n            if(data.statusCode == \"0\")\r\n            {\r\n                var accessToken = data.token;\r\n                var userType = data.role;\r\n                localStorage.setItem('user', accessToken);\r\n                localStorage.setItem('userType', userType);\r\n                this.props.dispatch(dispatchItem('ACCESS_TOKEN', { accessToken: accessToken, userType: userType }));\r\n                this.props.dispatch(dispatchItem('LOGIN_ACCESS_TOKEN', ''));\r\n                this.props.dispatch(dispatchItem('POPUP', ''));\r\n\r\n                if(userType ==  'Sales')\r\n                {\r\n                    this.props.history.push('/agent/company/detail');   \r\n                }\r\n                else if(userType ==  'Standart')\r\n                {\r\n                    this.props.history.push('/user');   \r\n                }\r\n            }\r\n            else if(data.statusCode == \"1\" || data.statusCode == \"2\") {\r\n                var accessToken = data.token;\r\n                this.props.dispatch(dispatchItem('LOGIN_ACCESS_TOKEN', accessToken));\r\n                this.changeActivePopup('changePassword');\r\n            }\r\n        }, () => {\r\n        }));\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"popup-container\">\r\n                <div className=\"popup-title\">\r\n                    Telefonuna Gelen SMS Kodunu Gir\r\n                </div>\r\n                <div className=\"form-container\">\r\n                    <Form model={this.state.formModel} handleSubmit={this.handleSubmit} smallTitle={\"\"} buttonText={\"Giriş Yap\"} />\r\n                </div>\r\n                <div className=\"popup-bottom\">\r\n                    <div>&nbsp;</div>\r\n                    <div className=\"popup-bottom-right\">Kalan süre: {(\"0\" + Math.floor(this.state.timer / 60)).slice(\"-2\")}:{(\"0\" + (this.state.timer % 60)).slice(\"-2\")}</div>\r\n                </div>\r\n            </div>\r\n        );\r\n        }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        app: state.app \r\n    }\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps)(OtpSmsPopup))"]},"metadata":{},"sourceType":"module"}